// SelectableButtons.jsx
import React, { useState } from "react";
import "bootstrap/dist/css/bootstrap.min.css";

const SelectableButtons = ({
  labels = [],
  selected = [],
  setSelected,
  buttonStyle = {},
  addFacilityLabel, // Function to add new facility labels
}) => {
  const [showInput, setShowInput] = useState(false);
  const [newLabel, setNewLabel] = useState("");

  const toggleSelection = (label) => {
    setSelected((prevSelected) =>
      prevSelected.includes(label)
        ? prevSelected.filter((item) => item !== label)
        : [...prevSelected, label]
    );
  };

  const handleAddCustomLabel = () => {
    if (newLabel.trim() && !selected.includes(newLabel.trim())) {
      setSelected((prevSelected) => [...prevSelected, newLabel.trim()]);
      if (addFacilityLabel && typeof addFacilityLabel === "function") {
        addFacilityLabel(newLabel.trim()); // Add to facility labels in MacbookAir
      }
      setNewLabel("");
      setShowInput(false);
    }
  };

  // Icon mappings for facilities
  const iconMap = {
    Obstacles: (
      <svg
        t="1741665378268"
        class="icon"
        viewBox="0 0 1024 1024"
        version="1.1"
        xmlns="http://www.w3.org/2000/svg"
        p-id="13526"
        width="16"
        height="16"
      >
        <path
          d="M870.8 897.6L703.1 513.2 512.6 76.4 153.3 897.6H67v50h890v-50h-86.2zM648.7 513.5l-365 210.8 103.6-236.7 199.9-115.4 61.5 141.3zM567 326.1l-145.9 84.3 91.5-209.1L567 326.1zM207.8 897.6l42-96.1 419-241.9L741 725 442 897.6H207.8z m334.2 0l219.1-126.5 55.2 126.5H542z"
          fill=""
          p-id="13527"
        ></path>
      </svg>
    ),
    Landmarks: (
      <svg
        t="1741665309834"
        class="icon"
        viewBox="0 0 1024 1024"
        version="1.1"
        xmlns="http://www.w3.org/2000/svg"
        p-id="11272"
        width="16"
        height="16"
      >
        <path
          d="M516.697248 80.937191C332.420607 80.937191 182.831334 231.249118 182.831334 414.803105c0 66.484121 19.511644 130.077629 55.644319 184.999294 0 0 0 0.722653 0.722653 0.722654 0.722653 1.445307 2.16796 2.890614 2.890614 4.335921 0.722653 1.445307 2.16796 2.890614 2.890614 3.613267l243.534227 323.026112c0.722653 0.722653 1.445307 2.16796 2.167961 2.890614 6.503881 6.503881 15.898377 10.117149 24.570219 10.117149 8.671842 0 18.066337-3.613267 24.570218-10.117149 0.722653-0.722653 1.445307-1.445307 2.167961-2.890614l23.847565-31.796754c8.671842-10.839802 6.503881-26.738179-5.058574-35.410021-10.839802-8.671842-26.738179-6.503881-35.410021 5.058574l-10.117149 13.730417-234.862386-311.463656c-31.0741-46.249824-46.972477-100.448836-46.972477-156.815808 0-156.093155 127.187015-283.280169 283.28017-283.280169s283.280169 127.187015 283.280169 283.280169c0 48.417784-12.285109 96.112915-35.410021 138.026817-6.503881 12.285109-2.16796 27.460833 10.117149 34.687368 12.285109 6.503881 27.460833 2.16796 34.687367-10.117149 27.460833-49.140438 41.913903-105.50741 41.913903-162.597036C850.563162 231.249118 700.973888 80.937191 516.697248 80.937191z"
          fill=""
          p-id="11273"
        ></path>
        <path
          d="M645.32957 414.080452c0-71.542696-57.812279-129.354975-129.354976-129.354976-71.542696 0-129.354975 57.812279-129.354975 129.354976s57.812279 129.354975 129.354975 129.354975c70.820042 0 129.354975-58.534933 129.354976-129.354975zM515.974594 492.849682c-43.35921 0-78.769231-35.410021-78.769231-78.76923s35.410021-78.769231 78.769231-78.769231 78.769231 35.410021 78.769231 78.769231-35.410021 78.769231-78.769231 78.76923z"
          fill=""
          p-id="11274"
        ></path>
        <path
          d="M612.087509 802.145378m-27.460833 0a27.460833 27.460833 0 1 0 54.921666 0 27.460833 27.460833 0 1 0-54.921666 0Z"
          fill=""
          p-id="11275"
        ></path>
        <path
          d="M669.899788 724.821454m-27.460832 0a27.460833 27.460833 0 1 0 54.921665 0 27.460833 27.460833 0 1 0-54.921665 0Z"
          fill=""
          p-id="11276"
        ></path>
        <path
          d="M726.989414 647.49753m-27.460832 0a27.460833 27.460833 0 1 0 54.921665 0 27.460833 27.460833 0 1 0-54.921665 0Z"
          fill=""
          p-id="11277"
        ></path>
      </svg>
    ),
    Service: (
      <svg
        t="1741665355244"
        class="icon"
        viewBox="0 0 1024 1024"
        version="1.1"
        xmlns="http://www.w3.org/2000/svg"
        p-id="12440"
        width="16"
        height="16"
      >
        <path
          d="M471.7 857.2c-23.1 0-46-9.9-61.6-28.9l-241.2-294c-37.6-45.8-54.9-103.3-48.7-162 6.2-58.9 35.2-111.8 81.8-149l9.2-7.4c46.4-37.1 104.6-54.1 163.9-47.9 53.1 5.5 101.4 29 137.9 66.7l8.2-6.5c47.6-38 108.1-54.5 170.3-46.3 61.7 8.1 117.8 39.5 158 88.4 21 25.6 36.3 54.3 45.6 85.4 9 30.1 11.9 61.1 8.7 91.9-6.3 59.5-35 112.4-81 149.1l-56.2 45c-3.5 4.2-7.4 8.1-11.7 11.6L521.3 839.8c-14.6 11.7-32.2 17.4-49.6 17.4z m-120-640.4c-38.4 0-77.1 12.5-109.2 38.1l-9.2 7.4c-36 28.8-58.5 69.7-63.3 115.1-4.8 45.3 8.6 89.7 37.6 125.1l241.2 294c10.2 12.4 28.7 14.3 41.3 4.2l233.6-186.6c1.9-1.5 3.6-3.3 5.1-5.2l1.9-2.5 60.9-48.8c35.4-28.3 57.6-69.3 62.5-115.3 5.3-50.1-10.1-100-43.2-140.4-66-80.3-181.9-95.9-258.5-34.7l-46.1 36.9-19.5-23.8c-34.3-41.8-84.5-63.5-135.1-63.5z"
          p-id="12441"
        ></path>
        <path
          d="M254.5 478.9c-6.2-31.5-6.8-59.8-1.6-84.1 5.1-23.9 15.6-44.3 31.3-60.6 49.5-51.5 128.3-40.9 137.2-39.5l-12.4 79h0.2c-11.9-1.7-49.9-2.5-67.5 16-16 16.9-13.6 49.3-8.8 73.6l-78.4 15.6z"
          p-id="12442"
        ></path>
      </svg>
    ),
    Elevator: (
      <svg
        t="1741665154700"
        class="icon"
        viewBox="0 0 1024 1024"
        version="1.1"
        xmlns="http://www.w3.org/2000/svg"
        p-id="8980"
        width="16"
        height="16"
      >
        <path
          d="M490.666667 746.666667v-128a21.333333 21.333333 0 0 1 42.666666 0v128h128a42.666667 42.666667 0 0 0 42.666667-42.666667V341.333333a42.666667 42.666667 0 0 0-42.666667-42.666666h-128v128a21.333333 21.333333 0 0 1-42.666666 0v-128h-128a42.666667 42.666667 0 0 0-42.666667 42.666666v362.666667a42.666667 42.666667 0 0 0 42.666667 42.666667h128z m0 127.936V832a21.333333 21.333333 0 0 1 42.666666 0v42.602667l23.914667-23.914667a21.333333 21.333333 0 0 1 30.186667 30.165333l-45.269334 45.248a42.666667 42.666667 0 0 1-60.330666 0l-45.269334-45.248a21.333333 21.333333 0 1 1 30.186667-30.165333L490.666667 874.581333zM533.333333 149.333333v64a21.333333 21.333333 0 0 1-42.666666 0V149.333333l-23.914667 23.914667a21.333333 21.333333 0 0 1-30.186667-30.165333l45.269334-45.248a42.666667 42.666667 0 0 1 60.330666 0l45.269334 45.248a21.333333 21.333333 0 1 1-30.186667 30.165333L533.333333 149.333333zM149.333333 106.666667a21.333333 21.333333 0 1 1 42.666667 0v810.666666a21.333333 21.333333 0 0 1-42.666667 0V106.666667z m213.333334 149.333333h298.666666a85.333333 85.333333 0 0 1 85.333334 85.333333v362.666667a85.333333 85.333333 0 0 1-85.333334 85.333333H362.666667a85.333333 85.333333 0 0 1-85.333334-85.333333V341.333333a85.333333 85.333333 0 0 1 85.333334-85.333333z m469.333333-149.333333a21.333333 21.333333 0 0 1 42.666667 0v810.666666a21.333333 21.333333 0 0 1-42.666667 0V106.666667z"
          fill="#515151"
          p-id="8981"
        ></path>
      </svg>
    ),
    Exhibition: (
      <svg
        t="1741665031775"
        class="icon"
        viewBox="0 0 1024 1024"
        version="1.1"
        xmlns="http://www.w3.org/2000/svg"
        p-id="7932"
        width="16"
        height="16"
      >
        <path
          d="M192 512a21.333333 21.333333 0 1 1 42.666667 0 21.333333 21.333333 0 0 1-42.666667 0z m21.333333-85.333333a85.333333 85.333333 0 1 0 0 170.666666 85.333333 85.333333 0 0 0 0-170.666666zM789.333333 512a21.333333 21.333333 0 1 1 42.666667 0 21.333333 21.333333 0 0 1-42.666667 0z m21.333334-85.333333a85.333333 85.333333 0 1 0 0 170.666666 85.333333 85.333333 0 0 0 0-170.666666z"
          fill="#515151"
          p-id="7933"
        ></path>
        <path
          d="M213.333333 554.666667a32 32 0 0 1 32 32v234.666666a32 32 0 0 1-64 0v-234.666666A32 32 0 0 1 213.333333 554.666667zM810.666667 554.666667a32 32 0 0 1 32 32v234.666666a32 32 0 0 1-64 0v-234.666666A32 32 0 0 1 810.666667 554.666667z"
          fill="#515151"
          p-id="7934"
        ></path>
        <path
          d="M128 842.666667a32 32 0 0 1 32-32h704a32 32 0 0 1 0 64H160a32 32 0 0 1-32-32zM318.72 641.28a32 32 0 0 1 45.226667 0 209.365333 209.365333 0 0 0 296.106666 0 32 32 0 1 1 45.226667 45.226667 273.365333 273.365333 0 0 1-386.56 0 32 32 0 0 1 0-45.226667zM597.333333 234.666667a21.333333 21.333333 0 0 1 21.333334 21.333333v170.666667a21.333333 21.333333 0 0 1-21.333334 21.333333h-170.666666a21.333333 21.333333 0 0 1-21.333334-21.333333V256a21.333333 21.333333 0 0 1 21.333334-21.333333h170.666666zM426.666667 170.666667a85.333333 85.333333 0 0 0-85.333334 85.333333v170.666667a85.333333 85.333333 0 0 0 85.333334 85.333333h170.666666a85.333333 85.333333 0 0 0 85.333334-85.333333V256a85.333333 85.333333 0 0 0-85.333334-85.333333h-170.666666z"
          fill="#515151"
          p-id="7935"
        ></path>
      </svg>
    ),
    Restrooms: (
      <svg
        className="icon"
        viewBox="0 0 1024 1024"
        version="1.1"
        xmlns="http://www.w3.org/2000/svg"
        width="16"
        height="16"
      >
        <path
          d="M288 128C217.6 128 160 185.6 160 256c0 35.616 15.264 67.744 39.008 91.008A161.312 161.312 0 0 0 128 480v180l64 32V896h192v-204l64-32V480a161.312 161.312 0 0 0-71.008-132.992C400.736 323.744 416 291.648 416 256c0-70.4-57.6-128-128-128z m416 0c-70.4 0-128 57.6-128 128 0 36.864 16.736 69.632 42.016 92.992a147.744 147.744 0 0 0-57.024 92.992v1.024l-48 255.008-8 37.984H608v160h192v-160h103.008l-8-38.016-48-254.976v-0.992a147.744 147.744 0 0 0-57.024-93.024C815.264 325.632 832 292.864 832 256c0-70.4-57.6-128-128-128zM288 192c35.744 0 64 28.256 64 64s-28.256 64-64 64-64-28.256-64-64 28.256-64 64-64z m416 0c35.744 0 64 28.256 64 64s-28.256 64-64 64-64-28.256-64-64 28.256-64 64-64zM288 384a96 96 0 0 1 96 96v140l-64 32V832H256v-180l-64-32V480a96 96 0 0 1 96-96z m416 0c39.36 0 72.864 26.112 80 68.992v0.992h0.992L826.016 672H736v160h-64v-160h-90.016l41.024-218.016h0.992v-0.96C631.136 410.112 664.64 384 704 384z"
          fill="#515151"
        />
      </svg>
    ),
    "+": (
      <svg
        className="icon"
        viewBox="0 0 1024 1024"
        version="1.1"
        xmlns="http://www.w3.org/2000/svg"
        width="14"
        height="14"
      >
        <path
          d="M925.696 384q19.456 0 37.376 7.68t30.72 20.48 20.48 30.72 7.68 37.376q0 20.48-7.68 37.888t-20.48 30.208-30.72 20.48-37.376 7.68l-287.744 0 0 287.744q0 20.48-7.68 37.888t-20.48 30.208-30.72 20.48-37.376 7.68q-20.48 0-37.888-7.68t-30.208-20.48-20.48-30.208-7.68-37.888l0-287.744-287.744 0q-20.48 0-37.888-7.68t-30.208-20.48-20.48-30.208-7.68-37.888q0-19.456 7.68-37.376t20.48-30.72 30.208-20.48 37.888-7.68l287.744 0 0-287.744q0-19.456 7.68-37.376t20.48-30.72 30.208-20.48 37.888-7.68q39.936 0 68.096 28.16t28.16 68.096l0 287.744 287.744 0z"
          fill="#515151"
        />
      </svg>
    ),
  };

  return (
    <div className="d-flex flex-wrap gap-2 justify-content-start">
      {labels.map((label) => (
        <button
          key={label}
          className="btn"
          style={{
            ...buttonStyle,
            fontWeight: "600",
            backgroundColor: selected.includes(label) ? "#3274f6" : "#6877932e",
            color: selected.includes(label) ? "white" : "grey",
            borderRadius: "10px",
            display: "flex",
            alignItems: "center",
            justifyContent: "center",
            fontSize: "12px",
            gap: "10px",
            height: "29px",
            minWidth: label === "+" ? "29px" : "80px", // Smaller width for "+" button
            padding: label === "+" ? "5px" : "10px 20px", // Adjust padding for "+" button
            border: "none",
            transition: "0.3s",
          }}
          onClick={() => {
            if (label === "+") {
              setShowInput(true);
            } else {
              toggleSelection(label);
            }
          }}
        >
          {iconMap[label] && <span>{iconMap[label]}</span>}
          {label !== "+" && label} {/* Do not display text for "+" button */}
        </button>
      ))}
      {showInput && (
        <div
          className="input-group"
          style={{ width: "auto", marginTop: "5px" }}
        >
          <input
            type="text"
            className="form-control"
            value={newLabel}
            onChange={(e) => setNewLabel(e.target.value)}
            placeholder="Enter new label"
            style={{ fontSize: "12px", height: "29px" }}
            onKeyPress={(e) => {
              if (e.key === "Enter") handleAddCustomLabel();
            }}
          />
          <button
            className="btn btn-primary"
            style={{ height: "29px", fontSize: "12px" }}
            onClick={handleAddCustomLabel}
          >
            Add
          </button>
          <button
            className="btn btn-secondary"
            style={{ height: "29px", fontSize: "12px", marginLeft: "5px" }}
            onClick={() => {
              setShowInput(false);
              setNewLabel("");
            }}
          >
            Cancel
          </button>
        </div>
      )}
    </div>
  );
};

export default SelectableButtons;
